<ion-header class="activities-header">
  <readonly></readonly>
  <custom-header [customHeader]="customHeader"></custom-header>
  <score-board
    [experienceBackgroundUrl]="experienceBackgroundUrl"
    [openEvent]="openEvent"
    [bookedEventsCount]="bookedEventsCount"
    [sameFontSize]="sameFontSize"
    [openLeaderboard]="openLeaderboard"
    [userExperiencePoint]="userExperiencePoint"
    [experiencePrimaryColor]="experiencePrimaryColor"
    [characterCurrentExperience]="characterCurrentExperience"
    [openPortfolio]="openPortfolio"
    [show_badge]="show_badge"
    [finalAverageScoreShow]="finalAverageScoreShow"
    [view_portfolio]="view_portfolio"
    [portfolio_request]="portfolio_request"
    [whatsThis]="whatsThis"
  ></score-board>
</ion-header>

<ion-content class="activities-content" no-bounce data-track-content>
  <ion-refresher *ngIf="checkUserPointer" (ionRefresh)="doRefresh($event)">
    <ion-refresher-content pullingIcon="arrow-dropdown"
      pullingText="Pull to refresh"
      refreshingSpinner="circles">
    </ion-refresher-content>
  </ion-refresher>

  <ion-list class="activity-error" *ngIf="returnError == true">
    {{ activitiesLoadingErr }}
  </ion-list>

  <ion-list class="activity-list" *ngFor="let activity of activities; let i = index">

    <div *ngIf="activity.Activity.is_locked == false"
      class="unlocked bg-color-{{i}} line-break"
      (click)="goToDetail(activity)">
      <p col-7 class="activity-title" data-content-name>
        {{ activity.Activity.name }}
        <span *ngIf="activity.Activity.name == 'Starter' && activities.length == 1">
          <i id="fingerPointer" class="fa fa-hand-o-left shake" aria-hidden="true"></i>
          Click Here
        </span>
      </p>

      <rainbow-icons col-3
        *ngIf="changeColor && changeColor[i]"
        class="ticks"
        [styling]="i"
        [colorings]="[
          changeColor[i][0],
          changeColor[i][1],
          changeColor[i][2],
          changeColor[i][3]
        ]"
      ></rainbow-icons>

      <p col-2 class="assessment-score" data-content-piece>
        <button block *ngIf="!show_score[i]">
          <i class="fa fa-clock-o" aria-hidden="true"></i>
        </button>
        <ion-badge *ngIf="show_score[i] && activity.Activity.name != 'Starter'"
          [ngClass]="{
            'best-grade-color': averageScore[i] >= 3.5,
            'better-grade-color': (averageScore[i] >= 2 && averageScore[i] < 3.5),
            'worse-grade-color': averageScore[i] < 2
          }">
          {{ averageScore[i] }}
        </ion-badge>
        <ion-badge *ngIf="show_score[i] && activity.Activity.name == 'Starter'"
          class="best-grade-color">
          <ion-icon name="checkmark"></ion-icon>
        </ion-badge>
      </p>
    </div>

    <div *ngIf="activity.Activity.is_locked == true" class="locked">
      <i class="fa fa-lock" aria-hidden="true"></i>
      <span (click)="goToPopup(activity.Activity.unlock_id)" class="line-break" data-content-name>
        {{ activity.Activity.name }}
      </span>
    </div>

  </ion-list>
</ion-content>
